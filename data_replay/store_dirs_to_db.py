# Copyright (c) 2017, MD2K Center of Excellence
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions are met:
#
# * Redistributions of source code must retain the above copyright notice, this
# list of conditions and the following disclaimer.
#
# * Redistributions in binary form must reproduce the above copyright notice,
# this list of conditions and the following disclaimer in the documentation
# and/or other materials provided with the distribution.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
# AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
# IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
# DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE
# FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
# SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER
# CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
# OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
# OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.


import os
import json
import yaml
import argparse
from db_helper_methods import SqlData

class ReplayCerebralCortexData:
    def __init__(self, users, config):
        """
        Constructor
        :param configuration:
        """
        self.config = config
        self.data_dir = self.config["data_replay"]["data_dir"]
        if (self.data_dir[-1] != '/'):
            self.data_dir += '/'

        self.sqlData = SqlData(config)
        self.users = users
        self.lab_participants = ["2abece47-2665-4c0b-a655-8b0dcb580033",
                                 "1f8c0264-c1b2-46ac-a6f6-d5cb236a3213",
                                 "d8385387-e6a1-434c-a83d-64dccbbebe9b",
                                 "5cf8676c-4be4-432a-afbf-444916b26c99",
                                 "59eb1e19-1cf3-4b02-b16a-f2e7bf718e59",
                                 "6f2bd39a-dcc1-4b8e-a5b8-722a93884e8d",
                                 "4ec7e880-c7a9-4648-bdc2-32606fbc5bb0",
                                 "e9d8e1c7-089d-4c27-87b7-a411f223d013",
                                 "82472824-3159-4a7b-b5ff-f4d8dce9b6d9",
                                 "d88b6641-b78f-41e9-b00b-0cd60004c27b",
                                 "4a677b36-c14a-4b2d-9dbd-9a9cc22e4686",
                                 "04d881cf-7fa7-441b-a6de-e5be72770ca0",
                                 "a9983b52-dec0-4056-93c5-34a5c17476db",
                                 "6dc6c0bb-cda0-498e-ba4e-f2e0df866abf",
                                 "9093af1e-f0e1-4776-97b9-6519a118b548",
                                 "663dc29d-45e1-419c-8ff8-8130bbb3f027",
                                 "e7d4927c-7a4c-436f-a6f1-f65c8909df06",
                                 "91699235-f137-4961-ac99-d0baf6f5455b",
                                 "46fde5eb-65fa-47bb-962d-bcf8bb455247",
                                 "ba346311-4c68-4632-8bc0-7d62ea21baed",
                                 "4ffe7bb5-fe6f-4c9f-abbc-75bf0d08d42e",
                                 "75345d17-a22c-4585-adfa-e22c1e858920",
                                 "3e5deedd-582b-4b27-88e2-abd2e2315293",
                                 "78465e2a-e7e6-4041-a547-32c26ebc8462",
                                 "c32a642e-9172-413f-9a0a-80719bbb2acb",
                                 "847a6b39-9ad8-43dc-85cd-14d6c6471e4e",
                                 "81e71930-3f17-4cc1-8485-f3905905bc2c",
                                 "252030f9-e9f7-46fd-bd49-042dcb4871ae",
                                 "a97479f4-e1db-4216-8179-fd736f21df20",
                                 "e8134551-f94f-4680-99f4-9b32dd308ec1",
                                 "af98fbc5-3d36-430f-9fed-c81a5117f870",
                                 "050c8700-12c8-41a5-a788-51c5db906227",
                                 "bbc22dd0-496b-48fd-9ee2-838711534e7e",
                                 "e0b4f912-9d0a-49fa-873e-1df65eff0fca",
                                 "a80e9633-8efc-4742-a22f-baa33c83d787",
                                 "faab2d54-d834-4697-9c66-cdd5f77b189d",
                                 "4fcd52f4-554c-47d6-93b2-a61602a6aad0",
                                 "3aa99659-7309-42a7-9a5f-9b8e73d8ff0c",
                                 "330dc20c-a66c-40a7-a487-74691cde70fd",
                                 "15086187-b3aa-4c7e-870b-112496d900f8",
                                 "a1752c4d-ef7c-4da6-a431-84bb43ce27aa",
                                 "43b75cc4-0cb6-4ea0-9446-b4432a3a72ba",
                                 "9c45db5e-ce3b-42bc-a946-18de3b21b5d5",
                                 "9539540b-d9b4-4926-b2fc-ddf7f3a4ee0a",
                                 "1607d2b8-84ea-469e-b1f2-ed4b7d151123",
                                 "0bdfbe6b-b4e1-44d6-9476-da7169c4b816",
                                 "a5363d91-b6a7-44d8-ad23-2ac9e14bfe29",
                                 "10a45080-b134-46f2-b427-061565ee21a2",
                                 "8546dc6e-2b45-46b8-bd76-85310f379194",
                                 "37070550-36b0-47ef-9a1e-9c7cca9a62c4",
                                 "7c47b948-75f0-4d49-a5af-3bd3d6c88f28",
                                 "ce943312-2a59-4230-9a08-d5cdf2ca4aef",
                                 "d9891f76-00ca-42b1-9203-1e2ed27a801a",
                                 "405790dc-6182-4153-9dbc-6ffa8f12def3",
                                 "3edfcff5-cbb2-4ea4-8550-7df36d76866d",
                                 "8d2224ee-69a0-4503-a74c-3e771b8ba42f",
                                 "7bd4119b-b008-43fa-9f4c-14ce1653008b",
                                 "a0af6319-9d4a-48e6-99c9-f4828d65147d",
                                 "87ffad6c-72da-42e3-b6d3-4bbaf16e1358",
                                 "e48c7f1b-e7f7-40db-a645-c23f0f7f7308",
                                 "251e0338-516f-4cd3-b362-e6748de5051a",
                                 "dd732925-92a0-42fe-b0e5-f3f37a32afeb",
                                 "51e50113-ade6-4dc8-b620-d64466db4ed9",
                                 "d3a6b98a-d08a-4125-87b7-50132993bcc3",
                                 "08b69389-3228-4be4-b9d8-0c85f5b4d55f",
                                 "8a2d4ad3-afb2-4407-ad4b-7336a165e7cc",
                                 "b20f38b5-60a4-4fd7-bc51-2fcc506e2268",
                                 "8af032a9-b59c-4a1b-a927-fb4151ddc032",
                                 "403e94ea-5ff7-4163-b3ca-38d219587f4c",
                                 "8729c06c-d3fd-4246-950f-b416c9a9e123",
                                 "02a6e937-5cbc-4ac6-aa63-1e286fced826",
                                 "c66a5313-f762-403f-85f1-af6cdee42540",
                                 "53c191d0-cbfd-444f-beb4-cfce1820284a",
                                 "ae6723b0-c174-4e8d-96b5-442263ea6bd5",
                                 "170c51eb-24a7-49b4-9785-adb2b747a136",
                                 "e8d6a3f7-ca19-4391-80cd-4eee174dc683",
                                 "f4b84c93-6f3c-42d4-a285-9e165f7ffd01",
                                 "f0aca125-c249-4a97-87da-ced52ef7cc38",
                                 "821c35b4-437f-4ebb-bc26-1308ac855a1d",
                                 "49146ca0-65ed-427f-95f5-3fd724f765f3",
                                 "4e1fc0ba-f2c1-4c89-9f44-5ee0eb5b0553",
                                 "1d2de8a9-70ce-409d-a5f2-d14e11751feb",
                                 "77bc0f3b-61cc-48a3-9f3a-75412aef788c",
                                 "a3b7529b-63c9-4854-949f-5ac7d383f6a6",
                                 "dcd29f60-88cc-42e0-b46f-d54957a82972",
                                 "7941a993-ce60-496a-9d9d-61fec81566db",
                                 "b2077d80-4d08-4b01-8769-960d7efae659",
                                 "c866adbd-fb39-4d18-88e3-e529b8d9f2be",
                                 "058e50a4-eeb9-474d-b6cd-33beb16cb85f",
                                 "2b260de4-47cf-424a-a5ca-e8aeaee73bd8",
                                 "074650d1-cb7e-42bf-827f-37cbb403bf6a",
                                 "3bdc8cb6-591f-409a-8611-6d072090b724",
                                 "e1824a6a-4eb2-4e9f-a7d8-46e80f06609d",
                                 "64e8aaa7-caf2-48cd-88c8-61905a2074a7",
                                 "9039d4de-639e-4886-ad80-bc045dd2ad33",
                                 "9f2a7b85-bd5e-43f2-b5c4-8f931c9a9a8e",
                                 "13772f23-e6e0-4905-a622-cdcab4430107",
                                 "412ba12f-0b43-415b-9f24-ca2e24cdc370",
                                 "b8beec33-5a7c-42e5-859a-60413334146c",
                                 "5b1141e1-cf04-4d80-8f7c-eeda0d1f11ed",
                                 "9d292efa-41e6-4cb3-9778-dd2d3647a72d",
                                 "7bd7979c-1c34-4213-b774-997dfd42c394",
                                 "edbe3080-065b-4994-90cd-6d00b7799039",
                                 "04585052-431f-46cf-bfbc-94bf42c380c8",
                                 "c2bb85e4-968f-40ff-845d-01a4751dd8d9",
                                 "79ae6619-899e-4c61-8ea7-91611e2db1fe",
                                 "3c27caea-9480-42fd-a4b6-09c0ce940dbb",
                                 "de798944-4d9b-4893-9a3b-cfceadf390a1",
                                 "3941554d-1002-49bf-8b0f-835a52366dee",
                                 "d805c05f-78c3-4c42-b144-ed85a2452267",
                                 "04a32e7a-df20-4ed9-a862-553b101dbd95",
                                 "51bb2efe-d70c-43b5-95e2-9215a54af190",
                                 "6c783bec-673d-4134-a474-19b547b8a88d",
                                 "b07d4c40-3702-47d7-94cb-7c23e6543ebf",
                                 "c49b8c38-9598-44fa-b600-a955eaca1bcd",
                                 "92bee527-399b-462a-abb6-a046d411365e",
                                 "6176804a-2784-40e8-8c5a-8b820f0d39d4",
                                 "52de689b-ddb6-4aae-8990-e5e96fcbd9bd",
                                 "b076def1-3a80-4553-a2ec-e06d2d0e38f1",
                                 "1d21160a-1ef5-4726-9d10-c323557af688",
                                 "528da8c5-5fa5-48d4-b144-331938ebb92a",
                                 "721dbb1a-f6bd-4dcd-95a8-562ada20ad35",
                                 "da725524-eee1-47e4-9d38-f39d505c3a59",
                                 "aa86fae6-e8cd-40a9-bfa9-75098d148db3",
                                 "1ff770a7-daa9-4957-9731-992c708a7255",
                                 "2da008a0-5b02-4852-9d6c-e303d49fe899",
                                 "a8d61a8c-b846-4a87-a144-e9034e2257cc",
                                 "e8a405bf-be1d-41d9-a6a6-a04cfaf92663",
                                 "45a39850-c2db-4b89-835c-13fb03a1a009",
                                 "218facda-0a80-4517-b636-f32c2b538387",
                                 "3afa8c4e-7375-494e-a388-8ff45cd8564e",
                                 "5fce1799-6045-46b0-b4ab-63a126f49bd2",
                                 "b1daeb70-bc79-4dec-83bb-85e7ba4eb2a5",
                                 "51fc5ec5-65de-4339-a2e7-91561c0e8bc1",
                                 "1f50209e-bb66-4c6f-a05f-ff1cc1c47937",
                                 "db009824-372d-4521-9366-3c06d2cb452f",
                                 "00f4eb18-54b6-483e-91f5-397ab624f6c5",
                                 "c466c258-72cf-4b8e-86f0-e553635a2993",
                                 "6dfd19a7-f8c0-428e-9d68-935ecea9494d",
                                 "570a2422-9037-4da9-89a9-2b4bbc114174",
                                 "f3033323-ec19-4180-b14c-f9b94be9b1d4",
                                 "c0034950-65c0-4747-a281-45a21165712d",
                                 "998700a0-5991-46ef-a2ba-bfeeb68d455a",
                                 "8a214710-a185-48b4-b110-419f2fce6481",
                                 "95e1569b-9741-4e88-89b7-3049fe806d82",
                                 "d1d4b2b9-372f-4d0f-8989-99cf0b386cad",
                                 "4a24c964-c91d-4b3f-bba0-3f2b3d2d52e5",
                                 "2154fe13-a51d-4c16-a77d-6597ad1f0d2e",
                                 "ca9822a9-bef5-4637-b48c-b9c0d7737612",
                                 "872d1ace-48ba-442b-b8c5-d0d94a39d48b",
                                 "74b85f5b-c687-42df-8933-7bb34320b950",
                                 "6c6f4b63-be6b-473f-9d52-517c8726e572",
                                 "3cdc739f-9049-4cb5-a97b-6dbff2540cd4",
                                 "fa49e752-5abf-4fa8-ad26-aecd6c925e64",
                                 "69337896-e33a-4963-9eb3-fe10b872243a",
                                 "2e4442e4-feee-48e9-9c67-b58ea3df8116",
                                 "3f041a3f-601f-44da-a725-47599d11bf77",
                                 "8804eda0-8138-498c-923a-0b95d2703fdd",
                                 "22a3bf5a-eef8-43ce-917a-8149e0977dc4",
                                 "fb9192ea-8f02-4a4d-b5dc-8b19b6c8479d",
                                 "f7642c6c-fe3a-4948-b0f8-62d4eb0bdd83",
                                 "1bea06b2-faa6-48f9-a661-d57d7b971fd6",
                                 "cd5c721f-9262-498c-9e3d-249f5f129682",
                                 "f3edcb53-66e7-4602-8ba1-b4fb472906ea",
                                 "2061e48f-ed96-4e94-a9b3-defb44f03047",
                                 "79b47600-ef22-4770-b637-adcb177d85ba",
                                 "724b8ddf-a3f6-4b25-83aa-3b162d69ad97",
                                 "19e6425f-3dbc-4e5c-b330-49fb65dc26d6",
                                 "c1aa28e0-4d34-40fa-9dd2-83397c28bd0b",
                                 "4262de28-0551-452a-9ca3-4efed6777ea7",
                                 "06bf4745-8df4-4644-ba03-3a114b508b87",
                                 "d9188708-dd39-48e5-be74-c78352f70860",
                                 "15c25c5f-f50b-4289-962c-d8dabee05731",
                                 "618d3992-22af-4b2e-af8d-19530a560cc3",
                                 "817552f3-8ff0-4a47-b419-5c010fedb07b",
                                 "ccad026b-cf84-4520-8c64-b24ccbb83248",
                                 "93c11031-4c3e-4e1e-a596-0359b53e111e",
                                 "41d23a15-9867-4ac8-966e-690ef70fd4a6",
                                 "f84bb687-1f07-4660-ad4a-f218a4a3c363",
                                 "10f260f6-850d-41d7-b2b1-ce5105359810",
                                 "57a2b0bd-6ccd-4928-8f11-001c42d08b51",
                                 "7af5d247-4e58-4885-beba-b08a65fec486",
                                 "295f8fee-0739-4c17-8840-a0b51cd43e6d",
                                 "24394618-9e39-443c-82fd-99083f1d5b15",
                                 "4f9a69ef-8106-401a-9921-8a9936dba685",
                                 "71af3748-57e2-4ad3-95b8-328390c7d225",
                                 "6c3c2bda-ed74-45c6-955c-56da201950ae",
                                 "6bcf2772-d6c7-4517-9f36-bfd325a56adb",
                                 "1f24102d-72d0-4626-ba7f-60c858a0a53e",
                                 "baa85387-7158-4bc0-8073-bf26957f58f9",
                                 "d61aa8d5-d54d-46ad-8f2f-3d86ed88d654",
                                 "8ad2353f-d618-4a33-bad4-c837c49d9774",
                                 "c779e7ed-40c4-407c-8c5d-4d22434e7257",
                                 "df125e86-a240-4b6c-9787-6573a50f91c1",
                                 "289b9165-d87b-479f-ac70-e157200f5409",
                                 "56d15f74-1aa8-47d7-9651-ebf6c99d23d5",
                                 "e2a95781-5958-4e24-b606-e888acc1e9f3",
                                 "b79851be-bbc3-4501-bc05-7e807f92b9bd",
                                 "de015a9e-9023-442d-a991-738f6095e040",
                                 "3ff9e162-a249-457d-9582-13a7562db83e",
                                 "aaa664e1-ba55-4860-9d22-cdbcfc7ffb70",
                                 "9941d2ee-5222-4e7e-b384-9e022b71f72e",
                                 "e5b6fb4f-0419-4185-bf42-05874b1ece79",
                                 "d682722e-51ed-45e3-a6fc-ac1fbe223b2f",
                                 "eaabfaeb-9e39-46a4-8b24-3f25fa5758fc",
                                 "1bf149a7-852b-4435-9df8-8d25a8070c73",
                                 "1bc5b120-7356-4ccb-91c9-d54e189ea905",
                                 "7a4fb765-09c4-4ef5-b085-0cb542d29e37",
                                 "bb385c88-2ccb-4360-ba45-6700d0961749",
                                 "353241ef-3289-4510-a193-c6b19ed7f26b",
                                 "a762d57b-55ec-42d5-88ec-846d70d780f7",
                                 "602cbc27-a808-4314-ac3e-1d12131e8abd",
                                 "7ff2c403-c554-4b79-b0cb-77bbbcc5f91d",
                                 "045741ed-00e5-47cd-9aac-da6a4982633f",
                                 "31d87b86-1595-48c0-9f36-61cb10b6b0dd",
                                 "197e8cde-67b7-4abc-88a1-f3735b115fe8",
                                 "f00127e7-fd11-48ce-9476-0358f4faa6fd",
                                 "a246d5af-4f2d-4946-8f23-ca0f9abd12be",
                                 "f1c9f52d-3926-4207-83ce-519907e585f8",
                                 "53f32620-02d7-42a2-83fe-ae9cfdbe9de4",
                                 "5eb24600-8e6a-4189-bc86-999c69db3f6c",
                                 "4e4cf692-1eba-46db-8f4a-8b0bcdb356c0",
                                 "9b4627f8-2983-48cf-9438-6abc22acec0c",
                                 "2d2cfeaa-3b65-4802-bf4e-c22184a126cd",
                                 "a3700023-6b8f-4964-a0e4-cbc822d6b80a",
                                 "3a15606a-b9b8-4b28-bb49-396a59ab66cc",
                                 "b5cda60f-af83-434c-b4d6-9ac8431637b8",
                                 "aa5a093d-dd9e-419e-9c79-b01cf6d0bd26",
                                 "781ab812-1e4f-4066-8118-0b4608f74328",
                                 "2862add9-44a6-40ae-8191-0420ad675cf2",
                                 "23e4f834-20c1-410c-95af-8b0831c0c6ef",
                                 "8f8d8834-359a-4f4b-9583-90eecb0977d7",
                                 "a594b6b7-f2f0-4b03-9ffa-834c22466294",
                                 "09b3f0ec-9c4d-4169-88fd-d951c1db661c",
                                 "9436fe37-db4d-47ef-8118-8244adf5012d",
                                 "9699333b-0589-4656-8a65-a9515a11974e",
                                 "7d6004fd-b5fe-48b7-b513-0afd51a243e0",
                                 "0f4c0ccf-bea2-4365-a9e6-47d4fd287155",
                                 "3b7b29a6-fdbd-499f-8aa4-f01d7561d915",
                                 "2f5a87af-c5c9-4eec-a889-a9d3a631fa64",
                                 "99c2df8a-de59-4b73-a991-1bebfdfda0fa",
                                 "6048664d-c378-4499-88a8-4ca773383ebe",
                                 "fa615b2a-40c0-4233-a932-100f6ee581aa",
                                 "b82752be-e84c-4a5c-a352-d837bd4610fe",
                                 "82386813-e3e6-4dac-b60a-194285cbd861",
                                 "de9e5366-cedb-4d94-b73d-4e804e5163e1",
                                 "06e8e060-9868-4a83-9aaf-ccd72234085c",
                                 "3406a7fb-2cd9-46bc-830e-9c94362d288c",
                                 "542442a7-1dbb-4a04-94f7-92d12d4ae493",
                                 "895bd410-ed38-4b3d-9edd-dd6824dae7b8",
                                 "ad12769f-4b80-4ccf-8287-e631adeea64a",
                                 "ee5edf6f-22e1-4745-97af-ebb3c56b5c62",
                                 "622a5f79-49da-4d31-967e-787bff13666d",
                                 "4adb6237-4e02-4d0a-b85c-1cbe1c41bd3c",
                                 "46c4c276-0cd8-49c9-9d7e-3af0064fba88",
                                 "541546ee-1050-4977-bb3a-7caf6db8e06c",
                                 "f57447d6-0946-449f-9b23-fd70169d546f",
                                 "736fc1c0-a28a-4539-bcf3-350b57e0341f",
                                 "f8f8724e-8773-401e-935c-a98442a50a1e",
                                 "a2aa1c97-0295-4f49-b3ba-7884848fb8c7",
                                 "7e79979f-c32a-4349-a0e6-aba1fd507094",
                                 "20fbd3d1-4990-476d-ab5c-99f45de65791",
                                 "627202b5-3c8b-4faf-ac0f-e7d972121348",
                                 "34afb26c-4458-4a3a-a91a-6d6059d884f8",
                                 "8f78e114-5aaf-4873-b80b-0c82322432aa",
                                 "7dc83703-e3fd-4859-bd23-e606ab5af2f6",
                                 "d83abde3-13de-4ee8-8581-26d6f52dc4f7",
                                 "d2327dee-adc0-4f70-8188-d971cba0a2a9",
                                 "e254252a-5062-46c9-9e2e-656ac92b9014",
                                 "b5933230-5cb0-405c-9642-d092dbc803ce",
                                 "97911cb5-fdc8-4e24-8bac-8314b5844898",
                                 "c1980290-2e35-4429-955a-fb6f6c6b4c4a",
                                 "494e9c60-55ae-4f06-a62d-06da1b3b4c78",
                                 "83dce74f-24e8-4e97-a872-bd0e306106f0",
                                 "896f67fb-6043-494a-9b12-dd91686def76",
                                 "87c10088-13a3-43cb-af7d-ba20b2ea4fc7",
                                 "06507046-e860-4bc7-9e45-bfa923ec3348",
                                 "66a882b2-2579-4f7e-a39e-9f4217570e05",
                                 "88a2b681-51b5-4b40-91df-1458444dafba",
                                 "1e9cce8d-49bd-4748-8ecf-e46181255314",
                                 "0ee35c7d-b9b7-462b-a6ec-c43cd6469c51",
                                 "ec433543-74f2-44bf-b83f-393d0f2fb8a5",
                                 "16bd026b-3b40-463b-b643-a40dd0a92529",
                                 "6f1a5bde-d095-41ff-8b91-aa44a1cb8ce6",
                                 "458b88b0-524c-4b5a-9185-ee68f92c8f68",
                                 "48cd5d36-4e5c-4261-ab92-f6b01cd88d96",
                                 "4e8fbb84-16d2-4926-bf08-219f96a6b7bc",
                                 "811adc5b-2600-46ba-acb9-eacd76693573",
                                 "4c30964b-2bd9-46cf-8716-ae3b7a7ec3ca",
                                 "96f02588-3d5f-4f90-b23c-06e4dd61646d",
                                 "833a5e38-b3d1-41bb-b6e1-6c2ee8dd3f2c",
                                 "2bec7c34-9565-4fcc-adca-d3426b3c6055",
                                 "23c2c753-2945-42af-ae9a-945f38f1cd59",
                                 "549daeb5-803c-4359-b35d-61af5d31bf4d",
                                 "3fb65a0b-21d8-471d-891f-50f16666b584",
                                 "5f2dd4f9-2c19-4aec-b867-c984c6c33d88",
                                 "9d9ba1eb-d9f1-4e4d-bdc0-ba36b65d64fc",
                                 "00162d05-3248-4b7d-b4f6-8593b4faaa63",
                                 "e8976d47-539a-425a-9505-b06b0adce8bb",
                                 "1202a63a-5f17-4f56-8f6c-45858f45b75a",
                                 "2f0b3625-db5b-4159-87c1-9c005fb8659e",
                                 "65f92f49-dec0-4da6-8396-e9d7046d934f",
                                 "d491bbc3-7ad8-4d34-9ace-38efc3c80497",
                                 "b8daecd6-1276-4b6b-9ed6-0ad8d2afad26",
                                 "f4608852-fa34-4a2a-8682-9ef7038af460",
                                 "a656341c-41a4-4dfc-a508-5b26058ae177",
                                 "1a13e2e5-5f64-49fb-bf2d-454030ceaebb",
                                 "bc91b676-b1eb-4332-a44f-f03af2d016ab",
                                 "7c7278f1-be44-41e4-b0d9-d9fa99116ce6",
                                 "863ae7e4-3eba-4062-b102-acd6df48abdc",
                                 "b61bcbe1-38ac-484f-ae35-13df248d8135",
                                 "e7157387-8c32-401c-a6fc-461d36bd96b6",
                                 "207a99f5-de40-48c1-a1be-508ab98d935d",
                                 "a3ce4c46-01c7-41a8-9591-1686a12673ad",
                                 "ea1c8352-a843-492d-b119-0dc4fdabe630",
                                 "a1e2f165-d872-4c94-9e3f-0d0d6c45fd93",
                                 "05cb11e7-2c05-4f16-99da-f408a3cc19e9",
                                 "a0d77195-f911-48b8-a1a2-fbf3ed7e668f",
                                 "206e63d6-061f-425d-bd28-b845c6dcc8cf",
                                 "4c4271e7-464a-43c8-b976-3e6a705e2b51",
                                 "a236102f-0eb3-49c2-9f80-b28f590e1862",
                                 "286078ea-79e3-4a76-a08b-79d9f8f657f2",
                                 "59a5080b-4230-4b35-bce6-3d9932777903",
                                 "6f0b8a9b-6fe2-4cda-9825-d0b130f438a4",
                                 "a26c79be-154c-4e8c-b533-0347e39ea761",
                                 "3ed9da7f-1df0-4214-8d6a-de9332f8bbcb",
                                 "629887c7-614f-439d-8485-23455b9b7528",
                                 "0db4b9ac-8bba-45ae-824d-8892695bed08",
                                 "c8c42ae1-4fda-48c8-8d19-58c7b76d1c3e",
                                 "28777465-663f-447a-b6e6-015b60d1543a",
                                 "12560bbf-8e86-42fa-8b7c-a06a9c987b90",
                                 "7cf3871c-a7ae-438d-83f8-3249264ff6c1",
                                 "ac787ead-563f-4d0a-92d1-1c595150dc5f",
                                 "a6260465-03bc-418f-af1f-b266cb7f1de1",
                                 "b3d3a191-b828-42f9-9f19-958c76a8e639",
                                 "714b9f6d-8a4b-47fd-ba3a-d277cbec666b",
                                 "8cfa8490-aec2-4032-9452-de9c4dccb94a",
                                 "d77ee136-0ded-4cca-87f0-a779bb6cd012",
                                 "39e57530-8c8a-41f6-8659-da7091c1a8eb",
                                 "64ce1bb3-97c8-419b-b1d9-e159cb50a8fa",
                                 "9b22305d-5327-40a7-8baf-4f54af4cc373",
                                 "09e87864-9585-42d7-ac1f-ff88cce577b0",
                                 "b105c482-2d09-48b8-9202-d8e4d97b515f",
                                 "e5fee47d-79ca-4cc4-95c2-f432f0f62379",
                                 "3a1574af-aed7-46c3-9daa-0cdb294624e2",
                                 "1d11d769-bdc9-4e6d-a6dd-c0d1096b4f1f",
                                 "6fee1601-108d-4c71-8c5e-700416e35b96",
                                 "a25ea7e0-a55a-4661-8713-0139950a249a",
                                 "2bc8eaff-9c14-4d7d-b25b-c6a6136c3055",
                                 "ffa5f232-e9c2-4491-943a-368c5e365274",
                                 "64d0b98a-3a8b-4c6f-bd96-a62f1c8ab0c2",
                                 "ed83bb04-e236-46b1-9e94-a48b1ce062df",
                                 "011c9939-4163-4150-a663-81d786409067",
                                 "3d9717ae-8a27-4f51-ab98-38579f0a523b",
                                 "a1cefba7-8887-4f68-8c4b-33d547077612",
                                 "e7b348b4-6455-471d-a2d3-69d2d3af9391",
                                 "1d967abc-61dc-48aa-b9ba-8023e6ba03b2",
                                 "217a6419-0769-4e30-926e-5bb655090cc8",
                                 "a5d23270-9348-4710-a08e-f739065ab333",
                                 "c6e06c21-f91c-47b9-96e4-a387d317fb5e",
                                 "9535ba9b-ef65-48f0-9334-3e769c399e20",
                                 "40e347fd-ee50-45e3-bb06-e340b217fd9c",
                                 "983a5399-b2bf-405b-bb4a-56451cf4fcfc",
                                 "2a2618fd-2455-4710-b7d7-e836294ffa65",
                                 "3768b4b7-292e-4581-a54f-c793d984fc1b",
                                 "63f6a5fb-e81c-4d51-a407-b2340eac54d9",
                                 "f5c54aaa-58b5-4faf-8cb3-aebd209cda06",
                                 "46f9ce89-626c-43f9-9c26-31c90351f06f",
                                 "6c83b804-146c-4957-b006-67b587079652",
                                 "4c7d0e75-7159-42fa-aff2-650adcb12533",
                                 "ca5a8451-fda7-4294-b7f3-9a7aae72bb7f",
                                 "e2c9f89f-1bef-41cf-a7f8-faf37df9dff9",
                                 "03a864c4-9136-44e0-8a25-d56bbf1fac7a",
                                 "26ceb4a5-264b-4daa-85eb-7b3dec2d73f9",
                                 "7488d063-41dd-4bd7-9107-3576bf82580e",
                                 "2b68ed71-1493-4e78-94ce-b2914ea8703a",
                                 "e6ed4836-24ca-4e90-a7df-e99816837c4d",
                                 "d28b5e79-d9a2-4c66-8a66-7a5e0cbb6b35",
                                 "c7d844a9-4811-4b2e-ba7d-78924dd67cad",
                                 "f686db8b-a7d6-4746-8fd8-a0cbc87e86f1",
                                 "3365a2c7-1391-449b-ba07-f70f1058e202",
                                 "ae2bf9eb-9a2b-4bea-b696-7929fa9249da",
                                 "1da7ae16-e37b-42d6-a7ac-18ed107928e3",
                                 "1eff71bf-bee2-4b40-81a3-3a7e3ac1f078",
                                 "84711f03-c31d-4ecc-a069-97e2c3b99e66",
                                 "73d1e4c8-958e-447f-9cca-0023ac990741",
                                 "a35c1edd-2040-469e-975c-70d5f0c4ec2b",
                                 "ab7f0efd-2331-404a-b30d-9e17076465ab",
                                 "0f36ea76-6f3a-4a9a-bf63-3a1f9c527319",
                                 "ce47bf60-75a9-4cb0-9b13-3e6d86fe9644",
                                 "d8a52beb-2c7a-4bd4-a388-a59cdcd35177",
                                 "42531cd7-eee6-4207-87d6-cafea35c807e",
                                 "9f1e9fd3-58c7-46ce-b30c-6e4238ca7038",
                                 "a97327c4-b9d7-4423-9735-7b649d3e2536",
                                 "667a0b46-1985-4283-8d80-228a5d8af523",
                                 "099a25bc-f7aa-4f36-9923-661a6e0ba3aa",
                                 "7bf37e3b-6f2a-4c68-aa00-a9f6a76059a6",
                                 "ed365c02-01a7-4554-a0f5-9c5e0862365f",
                                 "bf3cf102-d41b-4f3f-8743-c0622d1b3f3d",
                                 "ea1d8509-2089-4273-a281-b7b2f6ed38b3",
                                 "846b8e06-d377-4ba1-808b-440f2b4edf0e",
                                 "cb21d802-8cef-4192-a740-1b9a65753b73",
                                 "6488de83-b6cd-4e34-82a5-53dcbb98fa46",
                                 "24982ec3-91f8-4ba1-8e43-2ba82b4acb96",
                                 "3389b7df-2d85-4e5d-95fd-a4ac2e6ebcb6",
                                 "653ef913-c3e4-420b-8fce-1955a5d182f7",
                                 "83e49c2c-8753-4b3b-8d74-5df54bd975d7",
                                 "95c9ae20-be96-4757-af3f-8698cc267b00",
                                 "e458a75b-b1b5-4604-b17f-922ca5ab16de",
                                 "08513dfd-9622-4386-8186-0a98b53a52e9",
                                 "85e41374-d956-49ff-9e45-d3adaa05edf3",
                                 "891a98be-49d4-4cfc-9776-c9fa087261be",
                                 "4a1d1bdb-bfb3-4a23-be35-adcc7667092b",
                                 "42581f86-3c1e-4af5-96cc-120f3ef18e73",
                                 "1bac0759-d3a1-4479-ab6d-40be54457e47",
                                 "c08ba5c8-256b-4d65-88bb-2cfedc8db7b6",
                                 "686f27d5-2ee0-460e-aece-3c5039855eba",
                                 "ac4c30f5-7ad7-4b3b-b866-cc9fa00e37a7",
                                 "7cf7850b-9fb6-4d1c-a1cf-3f31b07ef7ee",
                                 "ddb8f78b-fa2d-468b-82ec-3c0b345d8f92",
                                 "d337f01e-6ec2-453f-922d-4fa8ef732188",
                                 "d7e53500-e584-43e4-a8e4-7239adfc04b0",
                                 "a9035e10-47d6-4af9-b758-1c1efc8f1b7b",
                                 "ec0dcfe4-be7b-4268-8bc7-b02184feacb1",
                                 "8ac28091-45a6-45fe-a510-21e694770661",
                                 "fa104184-5b8e-4d81-8334-8b72cacd24c7",
                                 "0ef145f6-d6bb-4a2d-9c37-160c6b2b092b",
                                 "b8d20582-413d-4a2d-872d-992895b74f15",
                                 "74dfaf60-f271-46bc-bafc-a2da0ddd8301",
                                 "c421300d-82e0-4de7-b2c4-975ab74f60bc",
                                 "09d3e834-6369-4b76-9037-07108b682fa2",
                                 "19abafa1-b554-4166-9a3f-f99a7d470de5",
                                 "59a8acb7-f570-42b6-9a61-5e0e272a9633",
                                 "c0f12c43-326a-47e2-b3e4-2622ee1b28fb",
                                 "7b0e52b1-a89e-4c4d-926d-af044baab8b8",
                                 "e7c0a079-96fa-48bd-ac49-63926e4a8d98",
                                 "72a342e8-3524-49fd-933b-cbe39a3f64c7",
                                 "82240ee0-241c-432b-ad97-05dceb4a5610",
                                 "3f4853c9-0705-47a3-bd71-64f0de86d178",
                                 "8d744336-64b5-43a7-b3cd-b9fa87c170af",
                                 "7017a996-8641-4e34-96d2-90470b36a7ee",
                                 "16f5caa0-4859-462b-83b7-0becaa7c390a",
                                 "76bae3fa-8b3d-4462-8029-226fc97b8f66",
                                 "ec8dfbc3-a55b-43d0-875c-bf877f3df9aa",
                                 "ce5caf37-5a83-4b37-8f1c-03c640ec48ea",
                                 "535c8c14-14a8-4728-84d8-a06a54dc111f",
                                 "1aa6ec23-f6d5-4660-9718-c63e3bf43e7a"]

        self.read_data_dir()

    def read_data_dir(self):
        for stream_dir in os.scandir(self.data_dir):
            if stream_dir.is_dir():
                owner = stream_dir.path[-36:]
                if self.users=="all":
                    self.scan_stream_dir(stream_dir)
                elif owner in self.lab_participants:
                        self.scan_stream_dir(stream_dir)

    def scan_stream_dir(self, stream_dir1):
        for day_dir in os.scandir(stream_dir1.path):
            if day_dir.is_dir():
                for stream_dir in os.scandir(day_dir):
                    if stream_dir.is_dir():
                        stream_dir = stream_dir.path
                        tmp = stream_dir.split("/")[-3:]
                        owner_id  = tmp[0]
                        day = tmp[1]
                        stream_id = tmp[2]
                        files_list = []
                        dir_size = 0
                        for f in os.listdir(stream_dir):
                            if f.endswith(".gz"):
                                new_filename = (stream_dir+"/"+f).replace(self.data_dir,"")
                                files_list.append(new_filename)
                                dir_size += os.path.getsize(stream_dir+"/"+f)
                        metadata_filename = self.data_dir+files_list[0].replace(".gz", ".json")
                        with open(metadata_filename, 'r') as mtd:
                            metadata = mtd.read()
                        metadata = json.loads(metadata)
                        stream_name = metadata["name"]
                        self.sqlData.add_to_db(owner_id, stream_id, stream_name, day, files_list, dir_size, metadata)

if __name__ == "__main__":

    parser = argparse.ArgumentParser(description='CerebralCortex Data Replay')
    parser.add_argument('-users','--users', help='Scan all users directories or only for the list provided in the script.', type=str, default="all", required=False)
    parser.add_argument('-conf','--conf', help='CerebralCortex configuration file', required=True)

    args = vars(parser.parse_args())

    with open(args["conf"]) as ymlfile:
        config = yaml.load(ymlfile)


    ReplayCerebralCortexData(args["users"],config)
